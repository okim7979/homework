#31
=

이번 문제는 'fsockopen'라는 함수를 이용하여 flag값을 얻어내도록 하는 것으로 보인다.

하지만 31번 문제에 접속해보면 연결에 실패했다는 문구가 보인다.

![](https://postfiles.pstatic.net/MjAxOTEyMDRfMTIy/MDAxNTc1NDU2NzkzMjc5.JW_s9HYW3AKhgc6Wzshuel7hTnbWgJAeI8-9UvDV6Tsg.chpPfKzD69hAySnxKpeG0dGL_ClM7NmhCHfnBjTw6yYg.JPEG.rlaeoghks823/K-027.jpg?type=w773)

이를 해결하기 위해 포트 10000-10100로 포트포워딩을 해주고  
cmd에서 'nc -lvp 10040'로 포트를 열어주면

```
C:\netcat>nc -lvp 10040
listening on [any] 10040 ...
000.000.000.000: inverse host lookup failed: h_errno 11004: NO_DATA
connect to [000.000.000.000] from (UNKNOWN) [000.000.000.000] 45510: NO_DATA
GET /FLAG{i_have_a_big_and_beautiful_server} HTTP/1.0
Host: 000.00.00.000
```
flag가 정상적으로 나오는 것을 확인 할 수 있다.

## 참고

### fsockopen 
* 열린 인터넷 또는 유닉스 도메인 소켓 연결

* hostname  
```
If OpenSSL support is installed, you may prefix the hostname with either ssl:// or tls:// to use an SSL or TLS client connection over TCP/IP to connect to the remote host.
```

* port  
```
The port number. This can be omitted and skipped with -1 for transports that do not use ports, such as unix://.
```

* errno  
```
If provided, holds the system level error number that occurred in the system-level connect() call.

If the value returned in errno is 0 and the function returned FALSE, it is an indication that the error occurred before the connect() call. This is most likely due to a problem initializing the socket.
```
* errstr  
```
The error message as a string.
```
* timeout  
```
The connection timeout, in seconds.
```
