#5
===

처음 문제에 접속해보면 `login`버튼과 `join`이라는 버튼 두개 밖에 없다.

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMTE3/MDAxNTc5NDE2NjM5MTM2.mBlWXsimCMorLjxPOvp2Q8uuzCny13JxDzjPEnoXIwIg.hkGq5ebjAx9Vx-73l-c241WQTqdbloeaJmdG5Rt0deIg.JPEG.rlaeoghks823/K-072.jpg?type=w773)

먼저 `join`을 눌러보면 access-denied라는 알림창만 뜨고 아무런 변화가 없다
![](https://postfiles.pstatic.net/MjAyMDAxMTlfOTUg/MDAxNTc5NDE2NjQzNDk0.2ko3hclwE54_j4yuLat6q6xlr3rWTT9PRrdwTUMvGucg.BhbfFUvBpbtP-yhLjummc1xuEJKzhfZTv900kPO9yyQg.JPEG.rlaeoghks823/K-073.jpg?type=w773)

그리고 `login`을 눌러보면 로그인창이 뜬다.

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMjI5/MDAxNTc5NDE2NjQ4NzY5.T0fWN4Cj26Rc8ACvCQoQmKggNC4cdQ7EMGghFqDxQHYg.EMmH0Q6fbPtHW8ePhxdJ-OVx8uJclDEguSLAINSsyLog.JPEG.rlaeoghks823/K-074.jpg?type=w773)

아무런 값이나 입력해서 로그인을 시도해보면

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMjky/MDAxNTc5NDE2NjUyODY0.J3BtMyVBeILC3eRtIvkSc2BGTdbKNwQrnjseppJ7nr8g.VwdGu1_A6lywGKPH_TJzdIZO2NDxxeYUysl_1pX3grkg.JPEG.rlaeoghks823/K-075.jpg?type=w773)

`Wrong password`라는 문구가 나온다.

여기서 더 이상 문제 해결 실마리를 찾지 못하여 소스 코드를 살펴보았다.

```php

<html>
<head>
<title>Challenge 5</title>
</head>
<body bgcolor=black>
<center>
<font color=black>
.<p>
.<p>
.<p>
.<p>
.<p>
.<p>
.<p>
</font>
<input type=button value='Login' style=border:0;width:100;background=black;color=green onmouseover=this.focus(); onclick=move('login');>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<input type=button value='Join' style=border:0;width:100;background=black;color=blue onmouseover=this.focus(); onclick=no();>

<script>
function no()
{
alert('Access_Denied');
}

function move(page)
{
if(page=='login') { location.href='mem/login.php'; }

}

</script>
</center>
</body>
</html>
```

처음 `login`버튼과 `join`버튼이 있는 페이지의 소스코드이다.

코드를 살펴보던 도중 `mem`이라는 폴더가 눈에 띄어 접속을 해보았다.

![](https://postfiles.pstatic.net/MjAyMDAxMTlfNzUg/MDAxNTc5NDE2NjU3MTI5.4fpTxqYtnPqbgucwtJOYxWblmioZQpy9-xzCRzMzASQg.K--80PNJMwheLUWfkwW_zOt-OkvZQnY0dQ9lvxXPZ4wg.JPEG.rlaeoghks823/K-076.jpg?type=w773)

바로 join.php에 접속을 해주었더니

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMjU5/MDAxNTc5NDE2NjU5OTcw.YuLIwane5G1Lql4zNuFw_QmpyQU4LUvg9rVZ0pYGC7Eg.0HoQutZIR4HFMWZmlwOWRhas4IkpWKs7Dw69l9RVWFwg.JPEG.rlaeoghks823/K-077.jpg?type=w773)

`bye`라는 알림창과 함께 검정 화면만 보인다.

그래서 다시 소스코드를 살펴보았더니

```php

<html>
<title>Challenge 5</title></head><body bgcolor=black><center>
<script>
l='a';ll='b';lll='c';llll='d';lllll='e';llllll='f';lllllll='g';llllllll='h';lllllllll='i';llllllllll='j';lllllllllll='k';llllllllllll='l';lllllllllllll='m';llllllllllllll='n';lllllllllllllll='o';llllllllllllllll='p';lllllllllllllllll='q';llllllllllllllllll='r';lllllllllllllllllll='s';llllllllllllllllllll='t';lllllllllllllllllllll='u';llllllllllllllllllllll='v';lllllllllllllllllllllll='w';llllllllllllllllllllllll='x';lllllllllllllllllllllllll='y';llllllllllllllllllllllllll='z';I='1';II='2';III='3';IIII='4';IIIII='5';IIIIII='6';IIIIIII='7';IIIIIIII='8';IIIIIIIII='9';IIIIIIIIII='0';li='.';ii='<';iii='>';lIllIllIllIllIllIllIllIllIllIl=lllllllllllllll+llllllllllll+llll+llllllllllllllllllllllllll+lllllllllllllll+lllllllllllll+ll+lllllllll+lllll;
lIIIIIIIIIIIIIIIIIIl=llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+lll+lllllllllllllll+lllllllllllllll+lllllllllll+lllllllll+lllll;if(eval(lIIIIIIIIIIIIIIIIIIl).indexOf(lIllIllIllIllIllIllIllIllIllIl)==-1) {alert('bye');throw "stop";}if(eval(llll+lllllllllllllll+lll+lllllllllllllllllllll+lllllllllllll+lllll+llllllllllllll+llllllllllllllllllll+li+'U'+'R'+'L').indexOf(lllllllllllll+lllllllllllllll+llll+lllll+'='+I)==-1){alert('access_denied');throw "stop";}else{document.write('<font size=2 color=white>Join</font><p>');document.write('.<p>.<p>.<p>.<p>.<p>');document.write('<form method=post action='+llllllllll+lllllllllllllll+lllllllll+llllllllllllll+li+llllllllllllllll+llllllll+llllllllllllllll
+'>');document.write('<table border=1><tr><td><font color=gray>id</font></td><td><input type=text name='+lllllllll+llll+' maxlength=20></td></tr>');document.write('<tr><td><font color=gray>pass</font></td><td><input type=text name='+llllllllllllllll+lllllllllllllllllllllll+'></td></tr>');document.write('<tr align=center><td colspan=2><input type=submit></td></tr></form></table>');}
</script>
</body>
</html>
```
script가 적용되어있음을 알 수 있었다.

이 script 부분을 깔끔하게 아래와 같이 정리해주었다.

```javascript
l = 'a';
ll = 'b';
lll = 'c';
llll = 'd';
lllll = 'e';
llllll = 'f';
lllllll = 'g';
llllllll = 'h';
lllllllll = 'i';
llllllllll = 'j';
lllllllllll = 'k';
llllllllllll = 'l';
lllllllllllll = 'm';
llllllllllllll = 'n';
lllllllllllllll = 'o';
llllllllllllllll = 'p';
lllllllllllllllll = 'q';
llllllllllllllllll = 'r';
lllllllllllllllllll = 's';
llllllllllllllllllll = 't';
lllllllllllllllllllll = 'u';
llllllllllllllllllllll = 'v';
lllllllllllllllllllllll = 'w';
llllllllllllllllllllllll = 'x';
lllllllllllllllllllllllll = 'y';
llllllllllllllllllllllllll = 'z';
I = '1';
II = '2';
III = '3';
IIII = '4';
IIIII = '5';
IIIIII = '6';
IIIIIII = '7';
IIIIIIII = '8';
IIIIIIIII = '9';
IIIIIIIIII = '0';
li = '.';
ii = '<';
iii = '>';
lIllIllIllIllIllIllIllIllIllIl = lllllllllllllll + llllllllllll + llll + llllllllllllllllllllllllll + lllllllllllllll + lllllllllllll + ll + lllllllll + lllll;
lIIIIIIIIIIIIIIIIIIl = llll + lllllllllllllll + lll + lllllllllllllllllllll + lllllllllllll + lllll + llllllllllllll + llllllllllllllllllll + li + lll + lllllllllllllll + lllllllllllllll + lllllllllll + lllllllll + lllll;
if (eval(lIIIIIIIIIIIIIIIIIIl).indexOf(lIllIllIllIllIllIllIllIllIllIl) == -1) {
    alert('bye');
    throw "stop";
}
if (eval(llll + lllllllllllllll + lll + lllllllllllllllllllll + lllllllllllll + lllll + llllllllllllll + llllllllllllllllllll + li + 'U' + 'R' + 'L').indexOf(lllllllllllll + lllllllllllllll + llll + lllll + '=' + I) == -1) {
    alert('access_denied');
    throw "stop";
} else {
    document.write('<font size=2 color=white>Join</font><p>');
    document.write('.<p>.<p>.<p>.<p>.<p>');
    document.write('<form method=post action=' + llllllllll + lllllllllllllll + lllllllll + llllllllllllll + li + llllllllllllllll + llllllll + llllllllllllllll + '>');
    document.write('<table border=1><tr><td><font color=gray>id</font></td><td><input type=text name=' + lllllllll + llll + ' maxlength=20></td></tr>');
    document.write('<tr><td><font color=gray>pass</font></td><td><input type=text name=' + llllllllllllllll + lllllllllllllllllllllll + '></td></tr>');
    document.write('<tr align=center><td colspan=2><input type=submit></td></tr></form></table>');
}
```

또한 I,l,1등으로 치환된 단어들을 모두 해석시켜 다시 적어본 소스코드는 다음과 같다.

```java
if (eval(document.cookie).indexOf(oldzombie) == -1) {
    alert('bye');
    throw "stop";
}
if (eval(document.URL).indexOf(mode=1) == -1) {
    alert('access_denied');
    throw "stop";
} else {
    document.write('<font size=2 color=white>Join</font><p>');
    document.write('.<p>.<p>.<p>.<p>.<p>');
    document.write('<form method=post action= join.php>');
    document.write('<table border=1><tr><td><font color=gray>id</font></td><td><input type=text name= id maxlength=20></td></tr>');
    document.write('<tr><td><font color=gray>pass</font></td><td><input type=text name= pw ></td></tr>');
    document.write('<tr align=center><td colspan=2><input type=submit></td></tr></form></table>');
}
```

쿠키값에 `oldzombie`가 있어야하고 url에 `mode=1`이 있어야 숨겨진 회원가입 창이 뜬다는 것을 알 수 있다.

따라서 쿠키값을 추가시켜주었고  
url에 `https://webhacking.kr/challenge/web-05/mem/join.php?mode=1`를 입력해주니 다음과 같이 입력창이 나왔다.

![](https://postfiles.pstatic.net/MjAyMDAxMTlfNTUg/MDAxNTc5NDE2NjYyNzky.KS9xMUo0vK92UTCUQmPf60kBosVO_g1qaSTw619Rg9og.OV3ckXU0bbjojuJL_5FTQILERWa72zG61UBMb46hAyMg.JPEG.rlaeoghks823/K-078.jpg?type=w773)

하지만 그냥 id에 admin을 입력 시 다음과 같은 창이 떴다

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMjMw/MDAxNTc5NDE2NjY2OTE3.7yO3UO7v7lOkMt7Sh0TmgKm4nH9uv6JpRRvhTmrFGBQg.dV9JI7o0sf2ww82qDgow9A0TLEs9dqV0r_lWcu1Bbcgg.JPEG.rlaeoghks823/K-079.jpg?type=w773)

이를 우회하기 위해 (스페이스바 4번)admin으로 id값을 넣어주고 비밀번호에 1234를 입력해주었더니

![](https://postfiles.pstatic.net/MjAyMDAxMTlfNjMg/MDAxNTc5NDE2NjcwODYy.emVXIxfwTZliDKi4C-iUFV0JMI2XdbK-AfEwgpEojIEg.NXrccLV7ASh-p1WTSCV6FP5bnxa2ZGIa8ZDHjl7R1FIg.JPEG.rlaeoghks823/K-080.jpg?type=w773)

정상적으로 회원가입이 되었다.

![](https://postfiles.pstatic.net/MjAyMDAxMTlfMjUx/MDAxNTc5NDE2Njc0NzI5.F2xb1UniVCFkIASJToAkT0N33DY1BNvrhgkQM_84-DEg.ZfcVJLt0h5XTA9wR48-ScrBkhKIKtKbRj9rrKgo8YWMg.JPEG.rlaeoghks823/K-081.jpg?type=w773)

바로 로그인창으로 들어가 id 값에는 (스페이스바 4번)admin, pw 값에는 1234를 입력해주었더니

![](https://postfiles.pstatic.net/MjAyMDAxMTlfNzQg/MDAxNTc5NDE2Njc3ODU1.vLsKZ71-bnkI3_iv6yZ9GGL8DaZGZeZDfZcZkosrv9Yg.JpWO7O9ajKOiFozPIsryqfzJf9Jc9xrg_jYz8Iq737Ig.JPEG.rlaeoghks823/K-082.jpg?type=w773)

문제가 해결되었다.
