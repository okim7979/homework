#6
=
6번 문제를 들어가보면 다음과 같은 화면을 볼 수 있다.

![](https://postfiles.pstatic.net/MjAxOTExMjJfMjEw/MDAxNTc0Mzk1Nzg4Mzk4.KD7GDFozM7Q6Lo4kv_orgmQqQppytWwC_ViJ44vCwGUg.Z8Erd2338zTCy4_yU9RXu4TQTlVr1YxeAz2tMWHD_vUg.PNG.rlaeoghks823/K-001.png?type=w773)

소스를 볼 수 있는 링크가 있으며 아래에는 
ID : guest
PW : 123qwe
가 있음을 확인 할 수 있다.

먼저 `view-source`를 통해 소스를 확인해보자.

```
<?php
include "../../config.php";
if($_GET['view_source']) view_source();
if(!$_COOKIE['user']){
  $val_id="guest";
  $val_pw="123qwe";
  for($i=0;$i<20;$i++){
    $val_id=base64_encode($val_id);
    $val_pw=base64_encode($val_pw);
  }
  $val_id=str_replace("1","!",$val_id);
  $val_id=str_replace("2","@",$val_id);
  $val_id=str_replace("3","$",$val_id);
  $val_id=str_replace("4","^",$val_id);
  $val_id=str_replace("5","&",$val_id);
  $val_id=str_replace("6","*",$val_id);
  $val_id=str_replace("7","(",$val_id);
  $val_id=str_replace("8",")",$val_id);

  $val_pw=str_replace("1","!",$val_pw);
  $val_pw=str_replace("2","@",$val_pw);
  $val_pw=str_replace("3","$",$val_pw);
  $val_pw=str_replace("4","^",$val_pw);
  $val_pw=str_replace("5","&",$val_pw);
  $val_pw=str_replace("6","*",$val_pw);
  $val_pw=str_replace("7","(",$val_pw);
  $val_pw=str_replace("8",")",$val_pw);

  Setcookie("user",$val_id,time()+86400,"/challenge/web-06/");
  Setcookie("password",$val_pw,time()+86400,"/challenge/web-06/");
  echo("<meta http-equiv=refresh content=0>");
  exit;
}
?>
<html>
<head>
<title>Challenge 6</title>
<style type="text/css">
body { background:black; color:white; font-size:10pt; }
</style>
</head>
<body>
<?php
$decode_id=$_COOKIE['user'];
$decode_pw=$_COOKIE['password'];

$decode_id=str_replace("!","1",$decode_id);
$decode_id=str_replace("@","2",$decode_id);
$decode_id=str_replace("$","3",$decode_id);
$decode_id=str_replace("^","4",$decode_id);
$decode_id=str_replace("&","5",$decode_id);
$decode_id=str_replace("*","6",$decode_id);
$decode_id=str_replace("(","7",$decode_id);
$decode_id=str_replace(")","8",$decode_id);

$decode_pw=str_replace("!","1",$decode_pw);
$decode_pw=str_replace("@","2",$decode_pw);
$decode_pw=str_replace("$","3",$decode_pw);
$decode_pw=str_replace("^","4",$decode_pw);
$decode_pw=str_replace("&","5",$decode_pw);
$decode_pw=str_replace("*","6",$decode_pw);
$decode_pw=str_replace("(","7",$decode_pw);
$decode_pw=str_replace(")","8",$decode_pw);

for($i=0;$i<20;$i++){
  $decode_id=base64_decode($decode_id);
  $decode_pw=base64_decode($decode_pw);
}

echo("<hr><a href=./?view_source=1 style=color:yellow;>view-source</a><br><br>");
echo("ID : $decode_id<br>PW : $decode_pw<hr>");

if($decode_id=="admin" && $decode_pw=="nimda"){
  solve(6);
}
?>
</body>
</html>

```
id와 pw를 20번 인코딩 후 `str_replace`시킨 다음 쿠키에 저장하고  
쿠키에서 값을 불러와서 다시 `str_replace` 후 id 와 pw를 출력해주는 것을 볼 수 있다.

또한 id 와 pw가 각각 admin과 nimda일 때 문제가 해결된다는 것도 확인이 가능하다.

즉 20번 디코딩한 값이 admin과 nimda이어야하므로  
admin과 nimda를 20번 인코딩한 값을 쿠키값에 넣어주면된다.

아래사이트에서 인코딩이 가능하며

https://ostermiller.org/calc/encode.html

결과는 다음과 같다
```
admin:
Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll5U2tWVQpiR2hvVFZWd1ZWWnRjRUpsUmxsNVUydFdWUXBpUjJodlZGWldkMVpXV25GUmJVWlVUV3hLU1ZadGRHdFhRWEJwVW01Q1VGZFdaREJTCmJWWkhWMjVTYWxKVmNITlZiWGh6VGxaVmVXUkdaRmRWV0VKd1ZXcEtiMlJzV2tkYVNIQnJDazFzV2toV01qVlRZV3hLV0ZWdFJsZGgKYTBZMFZHeGFWbVZYVWtkYVJtUldWMFZLZDFaWGNFdGlNbEp6VjJ0a1lWTklRbkpEYXpGelYydG9XR0V4Y0hKWFZscExVakZPYzFacwpWbGNLVFRBME1GWkhkR0ZoTWs1MFVtdGFZVkpzY0doVVZFSkxaREZhV0UxVVVtdE5WMUpZVjJ0YWIySkdTbk5qU0VwRVlYcEdlbFl5CmRHOVdNREZ4Vm14U1dsWXphRXhXTUZwWFl6RmFjd3BXYkdOTFZGUkJNRTFHV2tobFIwWlhZbFphV1ZaWGRHdFpWa3AwVld4a1YwMUcKV2t4YVJFWmhWMGRPUm1SSGJFNWlSWEEyVm1wS01HRXhiRmRVYTJ4U1ltdHdSVmxZY0VkbGJGbDVDbVJIT1ZkTlJFWjRWbTEwYjFZeApXalpTYTNoWFlsaG9jbGw2Um1GamQzQlhZa2RPVEZaR1VrSk5SVEZIVjJ0b2JGSXdXbGhaYkZwaFYxWmFXR1JIZEZwV2EzQXdWbGQ0CmExWXdNVWNLVjJ0NFlWSkZXbWhXTUdSUFVtMVNTR0pGTldsU1dFRXlWbTF3UzAxSFJYaGFSV2hVWVRKb1YxbHRkSGRTVm14WlkwVmsKV0ZKdGRETkRiR1IwVDFaa1RsSkZXalJXYlRFMFZURmtjd3BYV0hCb1VsaG9XRmxzVWtkVlJsVjRWMnhPYW1RelFsbFpiR1F3VkVaYQpkR1JHWkZwV2JIQllWako0VjFVeVNsWlhiVVpYWVd0YVRGVXhXbUZYUjFKSVQxZG9UbFpZUVhkWFZsWmhDbFF4V1hkTlZXTkxWakowCk5GbFdTa1pYYldoWFRVWldORlZzV2t0ak1VNXlUbFprYVZORlNrdFdiWEJMVFVac1dGSllhR2xTYlZKVldWUkdkMVpXYkhKWGEzUlQKVm0xNGVsWnROV3NLVjBaS2MySkVWa1JpVmtwSlZERmFhMVJzU2taWGFsSlhZbFJGTUZaVVJtdGpkM0JZVjBoQ2IxVnNhRzlYUmxKVwpWMjVrV0ZKdGR6SlZiVEZIWVcxUmVsRnNhRnBoTWxKUVZrVmFZUXBTTVZaeVpFZHNUbFpyY0ZsV2FrbzBWakZWZVZOc1dsaGlWVnBZCldWZDBZVlJHVlhoWGJVWllVakZLU2xaSGVHdFdNREZKVVd4d1dGWnNXbWhEYlVWNFYxaGtUbFpYVGt4V2Frb3dDazVHV1hsVGEyUnEKVTBWd1dGUlZaRk5YUmxWM1drWk9WRkl3Y0VkVWJHUnpWVEZrUmxKWWJGZGlWRVl6VlhwQmVGTkdTbGxoUjJ4VFlsWktWMWRXVWt0TwpSbFY0WWtoU2ExTkhVbFFLVm0weE5GZHNhM2RXYlhOTFdXdGtTMUl5U2tWV2ExSnBWbXR3U2xaRVJtRmhNVkp6VTJ0YVdHRnNTbGhaCmJGSkdUVVphVlZKc2NHeFJXRUpWVmpCb1EySXhWbkZUYlRsWFRWZDRXUXBhUldSSFZteEtkR1I2U2xaaVZFWklXVmN4VW1Wc1JuTmgKUm5Cb1RXeEtVVlpyVm1GWlVYQlRUVlphZVZVeWN6RlZNVnBHVjJ0c1YyRnJiM2RaYWtwR1pVWk9XVnBHYUdsV1IzaFhDbFp0Y0U5VQpiVlpIVld4YVdHSkhVbkpWYWtaTFUxWndSbGR1WkZkTmExWTFXa2h3UjFkR1duTlhiV2hFWWxWV05GWXhhR3RVYkZwWVZHdDRWMkZyCmIzZERhelZIVjFoc1ZHRXlVbkVLVlRCV2QxZEdVbFphUms1WVVteFdNMVl5ZERCaGF6RlhWMjVzVldKR2NISldSM2hoVjFaR2RGSnMKWkdsV1JWbDZWbGh3UW1WR1RrZFRiR3hvVW0xb2NGbHJWbmRXVmxweFVXMTBUd3BTYkd3MFdXdG9TMWRIU2xaWGJGRkxWbTB3ZUU1RwpaSE5oTTJSWFlsaE9URlpxUW1GVE1rMTRWMjVHVjJFeFNuQldiWGgzVTJ4YVJWSnRSbWhOVmtwNlZUSjBZVmRIUm5OVGJHaGFDbUpHClNrZFVWVnBYVmxaS2MyTkhlRlpYUlVwVlYxY3hNR1F5VGxkV2JrNW9VbnBzV1ZWdE1UUmxaM0JhVmxkTk1WbFhNVXRUUjFJMlUyeGEKVG1Kc1NubFdiRkpMVlcxV2MxSnVUbWdLVW01Q2IxUlhlRXRWVmxweVZtMUdhR1F6UWxsVmFrWkxVMVpSZUZkcmRHaFdiSEI2V1RCUwpZVll5Um5KaE0yaFhWa1Z3U0ZsNlJrOWpNa1pIVjIxc1UwMVZjRmhEYkZwMFRWUlNhd3BOYkZwNlZsYzFTMWRIU2tsUmJrNVhZa1pLCldGWnFSbEpsUm1SMVdrWmtUbUV4V1RGWGEyaDNVakZrUjFkdVRsaGlWMmhGV1d0YVIwNUdXWGhoUjNSVllrWndXVlpIZERSV01rWnkKQ21JelpFUmhlbFpJV1d0YWExZEdaRWxSYlRoTFZsUkNWMlF4WkVkaVJtaHJVakJhVDFSV1dtRmxiRmw1WkVkMGFHRjZSbGhWTW5CRApWMnhhV0ZWVVFscFdiSEJNV2taYVIyTXhaSE1LV2tkc1dGSXlhRnBXYWtaaFdWWlplVlZyWkZkaVIzaHZWVzEwZDJOR1ZuTmhSVTVXClRWWndNRnBGV2s5VlozQm9aVzE0VkZaVldsSmtNVUpTVUZRd1BRPT0=

nimda:
Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll5U2tWVQpiR2hvVFZWd1ZWWnFRbUZUTWxKSVZtdGtXQXBpUm5CUFdWZDBSbVZHV25SalJVcHNVbXhzTlZVeWRGZFdVWEJwVWpKb2RsWkdaSHBrCk1sWkhWMjVTYWxKWFVtRldha0Y0VGxaVmVXUkdaRmRWV0VKd1ZXcEtiMlJzV2tkWGJHUnJDazFXY0ZoV01qVlRZV3hLV0ZWc1ZsVlcKTTJoTVZURmFZV1JIVWtkYVJscGhUVEJLZDFadGVHRmtNV1JYVjI1U1RsWkdTbkZEYXpGRlVXcFNWMDFxVmxSWlYzaExWbTFPU1ZScwpXbWtLVjBkb05sWkhlR0ZXYlZaWVZXdGtZVkp0VWxkV01GWkxaREZhV0dORmRHbE5iRXA2VmpKMGExZEhTa2hWYmtwRVlYcEdXRmt3CldtOVdNREZ4Vm10b1YxWjZSa3hXYlhocll6RmFjd3BXYkdOTFZGUktiMVJXV2xWU2JVWmFWakZLU1ZaWGRHOWhNVXAwWVVaT1YwMUcKV2t4YVJFWmhWMFV4UlZKc1NrNVdiSEJKVmpKMFlXRXhiRmRUYTFwVVlrWktSVmxzVm5kWFJsbDVDbVJIT1ZkTlJFWjRWbTE0VTFkcwpXWHBoUlhoWFRWWndXRmw2Um1GamQzQlhZa2RPVEZkWGRHRmtNRFZ6VjJ0b2JGSXdXbGhaYkZwaFYxWmFXR1JIZEZwV2EzQXdWbGQ0CmExWXdNVWNLVjJ0NFlWSkZXbWhXTUdSUFVtMVNTR0pGTldsU1dFRXlWbTF3UzAxSFJYaGFSV2hVWVRKb1YxbHRkSGRTVm14WlkwVmsKV0ZKdGRETkRiR1IwVDFaa1RsSkZXalJXYlRFMFZURmtjd3BYV0hCb1VsaG9XRmxzVWtkVlJsVjRWMnhPYW1RelFsbFpiR1F3VkVaYQpkR1JHWkZwV2JIQllWako0VjFVeVNsWlhiVVpYWVd0YVRGVXhXbUZYUjFKSVQxZG9UbFpZUVhkWFZsWmhDbFF4V1hkTlZXTkxWakowCk5GbFdTa1pYYldoWFRVWldORlZzV2t0ak1VNXlUbFprYVZORlNrdFdiWEJMVFVac1dGTllhRlppYXpWV1dWUktiMkl4VlhkV2EzUlQKVm0xNFdsa3dWbXNLVjBaS2MySkVWa1JpVmxwSlZERmFiMVV3TVVkWFZFSllWa1ZLZGxWNlJtdFNkM0JZWW1zMWNWVnNhRzlXTVd4WQpaRWRHVmxKdVFrZFdNblF3WVcxUmVsRnRhRlpoYTNCeVZrVmFhd3BXTVZaeVZHeG9hR1ZyV2tsV2Frb3dZakpGZUZOWVpGaGlWR3hXClZtcE9UbVZHVWxaWGJHUnJVakZLU1ZwRlduZFdNa1Y1WkhwR1dGWnNXbkpEYlVsNFYyeGtXR0V4YkV4V1ZFb3dDazVHV1hsVGEyUnEKVTBWd1dGUlZaRk5YUmxWM1drWk9WRkl3Y0VkVWJHUnpWVEZrUmxKWWJGZGlWRVl6VlhwQmVGTkdTbGxoUjJ4VFlsWktWMWRXVWt0TwpSbFY0WWtoU2ExTkhVbFFLVm0weE5GZHNhM2RXYlhOTFdXdGtTMUl5U2tWV2ExSnBWbXR3U2xaRVJtRmhNVkp6VTJ0YVdHRnNTbGhaCmJGSkdUVVphVlZKdGRHcGtNMEpaVmpCb1EySXhWbk5oUnpsWVVteEtWd3BXTWpWclYwWktkR1I2U2xaaVZFWklXVmN4VW1Wc1JuTmgKUm5Cb1RXeEtVVlpyVm1GWlVYQlRUVlphZVZVeWN6RlZNVnBHVjJ0c1YyRnJiM2RaYWtwTFVqRk9XVnBHYUdsV1ZuQlpDbGRYZUc5VQpiVlpIVmxob1dHSlZXbGxWYWtaTFUyeGFTR1ZIZEZkTlJFWktWVmQ0ZDFkR1duTlhiV2hFWWxWV05GWXhhR3RVYkZwWVZHdDRWMkZyCmIzZERhelZIVjFoc1ZHRXlVbkVLVlRCV2QxZEdVbFphUms1WVVteFdNMVl5ZERCaGF6RlhWMjVzVldKR2NISldSM2hoVjFaR2RGSnMKWkdsV1JWbDZWbGh3UW1WR1RrZFRiR3hvVW0xb2NGbHJWbmRXVmxweFVXMTBUd3BTYkd3MFdXdG9TMWRIU2xaWGJGRkxWbTB3ZUU1RwpaSE5oTTJSWFlsaE9URlpxUW1GVE1rMTRWMjVHVjJFeFNuQldiWGgzVTJ4YVJWSnRSbWhOVmtwNlZUSjBZVmRIUm5OVGJHaGFDbUpHClNrZFVWVnBYVmxaS2MyTkhlRlpYUlVwVlYxY3hNR1F5VGxkV2JrNW9VbnBzV1ZWdE1UUmxaM0JhVmxkTk1WbFhNVXRUUjFJMlUyeGEKVG1Kc1NubFdiRkpMVlcxV2MxSnVUbWdLVW01Q2IxUlhlRXRWVmxweVZtMUdhR1F6UWxsVmFrWkxVMVpSZUZkcmRHaFdiSEI2V1RCUwpZVll5Um5KaE0yaFhWa1Z3U0ZsNlJrOWpNa1pIVjIxc1UwMVZjRmhEYkZwMFRWUlNhd3BOYkZwNlZsYzFTMWRIU2tsUmJrNVhZa1pLCldGWnFSbEpsUm1SMVdrWmtUbUV4V1RGWGEyaDNVakZrUjFkdVRsaGlWMmhGV1d0YVIwNUdXWGhoUjNSVllrWndXVlpIZERSV01rWnkKQ21JelpFUmhlbFpJV1d0YWExZEdaRWxSYlRoTFZsUkNWMlF4WkVkaVJtaHJVakJhVDFSV1dtRmxiRmw1WkVkMGFHRjZSbGhWTW5CRApWMnhhV0ZWVVFscFdiSEJNV2taYVIyTXhaSE1LV2tkc1dGSXlhRnBXYWtaaFdWWlplVlZyWkZkaVIzaHZWVzEwZDJOR1ZuTmhSVTVXClRWWndNRnBGV2s5VlozQm9aVzE0VkZaVldsSmtNVUpTVUZRd1BRPT0=
```

크롬의 EditThisCookie라는 확장프로그램을 이용하여 쿠키에 저 값들을 넣어주니 해결되었다.


![](https://postfiles.pstatic.net/MjAxOTExMjJfMjgz/MDAxNTc0Mzk4NDg0MzA4.R9UzPxYG5t_tKlWZ8h_knXCz7IKEIcfKns5eypsCzOwg.Ebz5O4r8zsnOApnNsyaaPHFcZf5AOufY0fkGEcDk0_gg.JPEG.rlaeoghks823/K-001.jpg?type=w773)

## 참고
### str_replace
     1번째 인수 : 변경대상 문자
     2번째 인수 : 변경하려는 문자
     3번째 인수 : 변수, replace가 바꾸고자 하는 문자열(변수수)
